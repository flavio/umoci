builds:
  - main: ./cmd/umoci
    flags:
      - -tags
    ldflags:
      - -X {{.ModulePath}}.gitCommit={{.Commit}} -X {{.ModulePath}}.version={{.Version}}
      - -s -w "{{if eq .Os "linux"}} -buildmode=pie {{end}}"
    env:
      - CGO_ENABLED=0
    goarch:
      - amd64
      - arm
      - arm64
      - 386
      - s390x
    goos:
      - linux
      - darwin
      - freebsd

archives:
  - name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}{{ if .Arm }}v{{ .Arm }}{{ end }}"
    replacements:
      386: i386
checksum:
  name_template: "checksums.txt"

signs:
  - cmd: gpg
    artifacts: all
    args: ["--armor", "--output", "${signature}", "--detach-sign", "${artifact}"]

# will remove once the PR is ready
release:
  github:
    owner: thesayyn
    name: umoci
